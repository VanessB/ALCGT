\section{Математические определения, утверждения и доказательства}
\label{sec:formal_systems}

В предыдущих разделах мы ввели внушительный математический аппарат, более-менее строго описывающий базовые математические объекты и связи между ними.
Настало время применить этот аппарат и для формального описания более сложных объектов.

\begin{definition}
    \label{definition:formal_systems:definition}
    \defemph{Определением} называется некоторый унарный предикат;
    он является индикаторной функцией множества объектов, удовлетворяющих определению.
\end{definition}

\begin{definition}
    \defemph{Математическим утверждением} называется формула, не имеющая свободных переменных (параметров), а потому либо истинная, либо ложная.
    Иногда утвеждением также называется предикат арности, большей нуля; в таком случае подразумевается, что перед ним стоят кванторы всеобщности по всем свободным переменным.
\end{definition}

\begin{definition}
    \defemph{Теоремой}, \defemph{леммой}, \defemph{предложением} или \defemph{утверждением} называется истинное математическое утверждение.
    Выбор конкретного названия обусловлен лишь ролью утверждения в математическом тексте.
\end{definition}

\begin{definition}
    \defemph{Критерием} называется истинное математическое утверждение вида
    \[
        \forall x \, \left( A(x) \leftrightarrow B(x) \right)
    \]
\end{definition}

Определим также несколько вспомогательных терминов, возникающих при рассмотрении математических утверждений определённого вида.
\begin{definition}
    Пусть имеется математическое утверждение вида
    \[
        \forall x \, \left( A(x) \rightarrow B(x) \right)
    \]
    Тогда говорится, что условие $ B(x) $ \defemph{необходимо} для выполнения $ A(x) $, а условие $ A(x) $ \defemph{достаточно} для выполнения $ B(x) $.
    Или, по-другому, условие $ A(x) $ более \defemph{сильное}, чем $ B(x) $, а $ B(x) $~--- более \defemph{слабое}, чем $ A(x) $.

    Если также имеются математические утверждения вида
    \[
        \forall x \, \left( A(x) \rightarrow C(x) \right), \qquad
        \forall x \, \left( B(x) \rightarrow C(x) \right),
    \]
    то второе из них считается более \defemph{сильным}, так как в нём $ C(x) $ следует из более слабого математического утверждения $ B(x) $.
\end{definition}



\subsection{Доказательства}
\label{subsec:formal_systems:proofs}

Наверняка вы заметили, как просто было доказать тавтологичность формул в алгебре логики: если совсем никак не получается это сделать преобразованием формул,
верный ответ всегда даст таблица истинности.
Проблемы начинаются при первой же попытке перейти к чему-то более сложному.
Реальные теоремы простым перебором всех аргументов предикатов не докажешь, ведь юнивёрсум может быть бесконечным.
Остаются только преобразования формул.

Во многом, формальная логика~--- это наука о переписывании формул.
В основу формальной системы ложатся некоторые аксиомы, тавтологичность которых постулируется, и некоторые правила вывода.
%позволяющие упрощать запись некоторого утверждения до тех пор, пока не будет показана его тавтологичность.
%Также наоборот, правила вывода позволяют получать из некоторого утверждения другие, истинные в предположении верности первоначального.
%Если в результате вывода получается противоречие, исходное утверждение ложно.
Основным правилом является \defemph{modus ponens}:
\[
    \typerule{A \rightarrow B, \quad A}{B}
\]
Данная запись, по существу, означает, что если истинно как утверждение $ A $, так и $ A \rightarrow B $, то истинно и $ B $.
На его основе можно сконструировать и более сложные правила, некоторые из которых даже имеют своё название.
\begin{example}
    \label{example:formal_systems:rules}
    \begin{enumerate}
        \item[]
        \item Несколько безымянных правил вывода:
           \[
                \typerule{A \vee B, \quad \neg A}{B} \qquad
                \typerule{A_1, \quad \ldots, \quad A_{n-1}, \quad \neg \left( \bigwedge_{k=1}^n A_k  \right)}{\neg A_n} \qquad
                \typerule{A \wedge B}{A} \qquad
                \typerule{B}{A \rightarrow B}
            \]
        \item Правило контрапозиции:
            \[
                \typerule{A \rightarrow B}{\neg B \rightarrow \neg A}
            \]
            (то есть, $ (A \rightarrow B) \leftrightarrow (\neg B \rightarrow \neg A) $~--- тавтология, как уже было показано в разделе про алгебру логики).
        \item <<От противного>>:
            \[
                \typerule{A \rightarrow B, \quad \neg B}{\neg A} \qquad
            \]
    \end{enumerate}
\end{example}

\begin{remark}
    В общем случае запись $ \; \displaystyle \typerule{A_1, \quad \ldots, \quad A_n}{B} \; $
    эквивалентна тавтологичности формулы $ \left( \bigwedge_{k=1}^n A \right) \rightarrow B $.
\end{remark}

Доказательство теоремы сводится либо к упрощению при помощи правил вывода входной формулы до уровня, когда тавтологичность проверяется легко,
либо к выводу из исходного утверждения и аксиом некоторого противоречия, которое будет говорить о том, что исходное утверждение ложно.
В нашем курсе, конечно, не придётся опускаться до таких формальностей, чтобы даже самые простые утверждения доказывать исключительно итеративным явным применением правил вывода.

Отдельно отметим правило вывода, не сводящееся к modus ponens: \defemph{математическую индукцию}.
Формальная запись:
\[
    \typerule{A(0), \quad \forall n \, \left( A(n) \rightarrow A(n+1) \right)}{\forall n \, A(n)}
\]
Данное правило либо постулируется, либо выводится из некоторых других аксиом.

\begin{Exercise}[counter=SecExercise]
    \noindent
    Получите формально правило
    \[
        \typerule{A \oplus B, \quad B}{\neg A}
    \]
    из modus ponens, правил в примере \ref{example:formal_systems:rules}, правил преобразования к связкам $ \neg $ и $ \rightarrow $, а также тавтологичности $ A \rightarrow (B \rightarrow A) $.
\end{Exercise}

\begin{Answer}
    \noindent
    Перейдём к отрицаниям и импликациям:
    \begin{multline*}
        A \oplus B = \neg(A \leftrightarrow B) = \neg \left[ (A \rightarrow B) \wedge (B \rightarrow A) \right] = \\
        =\neg (A \rightarrow B) \vee \neg (B \rightarrow A) = (A \rightarrow B) \rightarrow \neg (B \rightarrow A)
    \end{multline*}
    Из правила в примере имеем
    \[
        \typerule{B}{A \rightarrow B}
    \]
    Применяя modus ponens к исходному утверждению и полученной формуле, получаем
    \[
        \typerule{A \rightarrow B, \quad (A \rightarrow B) \rightarrow \neg (B \rightarrow A)}{\neg (B \rightarrow A)}
    \]
    Правило <<от противного>>:
    \[
        \typerule{A \rightarrow (B \rightarrow A)}{\neg (B \rightarrow A) \rightarrow \neg A} \qquad
    \]
    Наконец,
    \[
        \typerule{\neg (B \rightarrow A) \rightarrow \neg A, \quad \neg (B \rightarrow A)}{\neg A}
    \]
\end{Answer}

Еще раз акцентируем внимание на том, что \textbf{не требуется излишне формализовывать процесс доказательства, если в этом нет необходимости!}
Изложенная выше теория должна помочь вам понять общую структуру процесса доказательства, увидеть некоторую его модульность,
переиспользование каких-то распространённых схем вывода как самостоятельных правил.

%Осталось упомянуть ещё один важный приём~--- \defemph{доказательстве от противного}.
%Он основывается на том факте, что если некоторое математическое утверждение $ A $ истинно,
%%(пускай мы это даже не знаем заранее, и тем более пускай мы не знаем доказательства истинности $ A $),
%то при предположении истинности $ \neg A $ истинно также $ A \wedge \neg A $.
%Это уже является противоречием, но при реальном доказательстве, конечно, именно это противоречие можно получить,
%только если доказать $ A $, что, казалось бы, делает этот способ бессмысленным.

%Однако на помощь приходит тот факт, что если доказуемо одно противоречие, то доказуемо всё, что угодно, в том числе и какое-то другое противоречие.
%Значит, если в процессе доказательства будет найдено любое другое противоречие, исходное предположение об истинности $ \neg A $ ложно.



\subsection{Примеры}
\label{subsec:formal_systems:examples}

Рассмотрим несколько примеров использования изученных в предыдущем разделе методов доказательства.

\begin{Exercise}[counter=SecExercise]
    \noindent
    Пусть $ A $, $ B $, $ C $~--- множества.
    Верно ли, что если $ A \cap B $ не является подмножеством $ C $, то или $ A \not\subseteq C $, или $ B \not\subseteq C $?
\end{Exercise}

\begin{Answer}
    \noindent
    Требуется проверить тавтологичность
    \[
        \neg (A \cap B \subseteq C) \rightarrow \left[ \neg (A \subseteq C) \wedge \neg (B \subseteq C) \right]
    \]
    Сделаем это, применив правило контрапозиции.
    \[
        \left[ (A \subseteq C) \vee (B \subseteq C) \right] \rightarrow (A \cap B \subseteq C)
    \]
    Можно <<добить>> это выражение формальными преобразованиями, но, в принципе, уже понятно, что если хотя бы одно множество полностью лежит в $ C $, то и пересечение тоже.

    Для тренировки упростим формулу до конца, введя стандартные обозначения для индикаторных функций и перейдя к алгебре логики:
    \[
        \left[ (a \rightarrow c) \vee (b \rightarrow c) \right] \rightarrow (a \wedge b \rightarrow c)
    \]
    Раскроем все импликации:
    \[
        \neg \left[ (\neg a \vee c) \vee (\neg b \vee c) \right] \vee (\neg(a \wedge b) \vee c)
    \]
    \[
        \neg [\neg a \vee \neg b \vee c] \vee (\neg a \vee \neg b \vee c)
    \]
    Тавтологичность доказана.
\end{Answer}


\begin{Exercise}[counter=SecExercise]
    \noindent
    Докажите, что если у числоой последовательности есть предел, то он единственнен.
\end{Exercise}

\begin{Answer}
    \noindent
    Характерный пример доказательство от противного.
    Предположим, что $ a \neq b $~--- два предела $ \{ x_n \}_{n=1}^{\infty} $.
    Определение предела:
    \[
        \forall \varepsilon > 0 \;\; \exists N: \; \forall n > N \;\; |x_n - a\,(b)| < \varepsilon
    \]
    Возьмём $ \varepsilon_0 = |b - a| / 3 > 0 $.
    Тогда
    \[
        \exists N_a: \; \forall n > N_a \;\; |x_n - a| < \varepsilon_0 \qquad
        \exists N_b: \; \forall n > N_b \;\; |x_n - b| < \varepsilon_0
    \]
    Обозначим $ x' = x_{\max \{N_a, N_b\} + 1} $.
    Тогда $ 3\varepsilon_0 = |a - b| = |a - x' + x' - b| \leqslant |a - x'| + |x' - b| < \varepsilon_0 + \varepsilon_0 <  3 \varepsilon_0 $.
    Противоречие
    Значит, либо $ a = b $, либо $ \{x_n\}_{n=1}^{\infty} $ не имеет предела.
\end{Answer}


\begin{Exercise}[counter=SecExercise]
    \noindent
    Пусть последовательность $ \{ x_n \}_{n=0}^{\infty} $ задана рекуррентным соотношением $ x_{n+1} = a x_n + b $, $ a \neq 1 $.
    Докажите, что
    \begin{equation}
        \label{eq:formal_systems:recursive}
        x_n = x_0 \cdot a^n + b \cdot \frac{a^n - 1}{a - 1}
    \end{equation}
\end{Exercise}

\begin{Answer}
    \noindent
    Докажем методом математической индукции.\\
    \textbf{База:} $ x_0 = x_0 \cdot 1 + b \cdot 0 = x_0 $.\\
    \textbf{Шаг:} пусть для некоторого $ n $ верно \eqref{eq:formal_systems:recursive}.
    Тогда
    \[
        x_{n+1} = a x_n + b = x_0 \cdot a \cdot a^n + b \cdot \left[ 1 + a \cdot \frac{a^n - 1}{a - 1} \right] = x_0 \cdot a^{n+1} + b \cdot \frac{a^{n+1} - 1}{a - 1}
    \]
    Итого, по индукции доказано.
\end{Answer}
