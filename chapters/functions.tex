\section{Функции}
\label{sec:functions}

Понятие функции уже встречалось нам ранее.
Например, оно фигурировало при определении \textit{булевой функции}, а также \textit{раскраски графа}.
Неформально, \defemph{функция}~--- это некоторое правило, в одностороннем порядке сопостовляющая каждому объекту из одного множества некоторый объект из другого множества.
Сопоставляемый объект не обязан быть уникальным, однако не может быть ситуации, когда одному элементу сопоставляются два и более.

Например, если некоторому действительному числу мы сопоставляем его квадрат, то это правило сопоставления~--- функция.
Если же мы попытаемся каждому положительному действительному числу $ y $ сопоставить решение уравнения $ x^2 = y $, то натолкнёмся на проблему неоднозначности:
функции не получается.

\subsection{Формальное определение}
\label{subsec:functions:definition}

На лекции вам давалось определение функции через понятие ориентированного двудольного графа.
В рамках семинара мы дадим другое, эквивалентное, но более часто используемое определение.
Для этого нам потребуется ввести некоторые вспомогательные обозначения.

\begin{definition}
    \defemph{Декартовым произведением} множеств $ A $ и $ B $ называется множество всех \defemph{упорядоченных пар}, где первый элемент взят из $ A $, а второй~--- из $ B $:
    \[
        A \times B = \{ (a, b) \mid a \in A, \; b \in B \}
    \]
    \textit{Напомним, что один из вариантов строгого определения упорядоченной пары давался в разделе \ref{subsec:sets:theory}.}
\end{definition}

Определение легко обобщается и на случай множественного произведения: вместо пар будут использоваться \defemph{кортежи}.
Также заметим, что $ A \times A $ обозначают как $ A^2 $.

\begin{definition}
    \label{definition:functions:function}
    \defemph{Функцией (частичной функцией)}, принимающей аргументы из множества $ X $ и значения во множестве $ Y $,
    называется подмножество $ f \subseteq X \times Y $ такое, что ни у каких двух пар из $ f $ первый элемент не совпадает.
    \\[0.25\baselineskip]
    Если $ x \in X $ и $ \exists y \in Y: (x, y) \in f $, то говорят, что функция $ f $ \defemph{определена} в точке $ x $, и $ f(x) = y $.
\end{definition}

\begin{example}
    Рассмотрим пару примеров функций и не функций.
    \begin{enumerate}
        \item
            $ X = \{ 0, 1 \} $, $ Y = \{ x, y \} $.
            Тогда $ X \times Y = \left\{ (0, x), (0, y), (1, x), (1, y) \right\} $.
            \newline
            $ f = \{ (0, y), (1, y) \} $ является функцией, в то время как
            $ g = \{ (0, x), (0, y), (1, x) \} $~--- нет, хотя и $ g \subseteq X \times Y $.
        \item
            $ X = \R_{+} $, $ Y = \R $.
            \newline
            $ f = \{ (x, x^2) \mid x \in X \} $ является функцией, в то время как
            $ g = \{ (x, y) \mid x \in X, \; y \in B, \; y^2 = x \} $~--- нет, хотя и $ g \subseteq X \times Y $.
    \end{enumerate}
\end{example}

Понятно, что каждый раз излишне формально определять функцию как множество пар не стоит.
Достаточно записать непосредственно правило, по которому одному элементу ставится в соответствие другой:
$ f: x \mapsto f(x) $.
Например, $ \exp: x \mapsto e^x $, или просто $ \exp(x) = e^x $.

Заметим, что функция не должна быть определена в каждой точке множества аргументов.
Например, функцию $ f(x) = 1 / |x| $ можно рассматривать в контексте $ X = Y = \R $, хотя она и не определена в точке $ x = 0 $.
Эта же самая функция также принимает не все возможные значения из $ Y $.
В этой связи полезно ввести следующие определения:

\begin{definition}
    \defemph{Областью определения} функции $ f \subseteq X \times Y $ называется множество
    \[
        \dom(f) = \{ x \in X \mid \exists y \in Y: f(x) = y \}
    \]
    \defemph{Областью значений} функции $ f \subseteq X \times Y $ называется множество
    \[
        \range(f) = \{ y \in Y \mid \exists x \in X: f(x) = y \}
    \]
\end{definition}

\begin{definition}
    Если $ f(x) = y $, то $ y $ называется \defemph{образом} элемента $ x $, а $ x $~--- \defemph{прообразом} элемента $ y $
\end{definition}

Также нас будет интересовать то, как функция отображает целое множество, а не только один элемент.
Для этого вводятся следующие определения:

\begin{definition}
    \defemph{Образом} некоторого подмножества $ A \subseteq X $ называется множество
    \[
        f(A) = \{ y \in Y \mid \exists x \in A: f(x) = y \}
    \]
    \defemph{Полным прообразом} некоторого подмножества $ B \subseteq Y $ называется множество
    \[
        f^{-1}(B) = %\{ x \in X \mid \exists y \in B: f(x) = y \} =
        \{ x \in X \mid f(x) \in B \}
    \]
    \defemph{Полным прообразом} некоторого элемента $ y \in Y $ называется полный прообраз множества $ \{ y \} $.
\end{definition}

\begin{remark}
    $ f(X) = f(\dom(f)) = \range(f) $, $ f^{-1}(Y) = f^{-1}(\range(f)) = \dom(f) $.
\end{remark}


\begin{Exercise}[counter=SecExercise, label={exercise:functions:sets_examples}]
    \noindent
    Частичная функция $ f $ из множества $ \{1, 2, \ldots, 8 \} $ в множество $ \{a, b, \ldots, e \} $ определена следующим образом:
    \[
        f: 1 \mapsto a, \quad 2 \mapsto a, \quad 3 \mapsto c, \quad 4 \mapsto d, \quad 5 \mapsto c, \quad 7 \mapsto d.
    \]
    Найдите
    \begin{enumerate}[label=\textbf{\alph*)}]
        \item $ \dom(f) $;
        \inlineitem $ \range(f) $;
        \inlineitem $ f(\{1, 2, 3\}) $;
        \inlineitem $ f^{-1}(c) $;
        \inlineitem $ f(\{1, 2, 3, 5, 6\}) $;
        \item $ f^{-1}(\{a, b, c\}) $.
    \end{enumerate}
\end{Exercise}

\begin{Answer}
    \noindent
    \begin{enumerate}[label=\textbf{\alph*)}]
        \item $ \dom(f) = \{1, 2, 3, 4, 5, 7\} $;
        \inlineitem $ \range(f) = \{a, c, d\} $;
        \inlineitem $ f(\{1, 2, 3\}) = \{a, c\} $;
        \item $ f^{-1}(c) = \{3, 5\} $;
        \inlineitem $ f(\{1, 2, 3, 5, 6\}) = \{a, c\} $;
        \inlineitem $ f^{-1}(\{a, b, c\}) = \{1, 2, 3, 5\} $.
    \end{enumerate}
\end{Answer}


\begin{Exercise}[counter=SecExercise, label={exercise:functions:max_prime_devisor}]
    \noindent
    Частичная функция $ g $ из множества положительных целых чисел в множество положительных целых чисел
    сопоставляет числу $ x $ наибольший простой делитель $ x $.
    \begin{enumerate}[label=\textbf{\alph*)}]
        \item Какова область определения $ g $?
        \item Верно ли, что если $ X $~--- конечное, то и $ g^{-1}(X) $ конечное?
        \item Найдите $ g^{-1}(3) $.
    \end{enumerate}
\end{Exercise}

\begin{Answer}
    \noindent
    \begin{enumerate}[label=\textbf{\alph*)}]
        \item
            Единица~--- единственное положительное число, не имеющее простых делителей.
            Поэтому $ \dom(f) = \N \setminus \{ 1 \} $.
        \item
            Нет, неверно.
            Пример~--- $ f^{-1}(\{ 2 \}) = \{ 2^n \mid n \in \N \} $.
            Действительно, у всех положительных целых степеней двойки, причём только у них, наибольший простой делитель~--- $ 2 $.
        \item
            Аналогично предыдущему пункту замечаем, что $ f^{-1}(\{ 3 \}) = \{ 2^n 3^m \mid n \in \N_0, \; m \in \N \} $.
            Действительно, раз наибольший простой делитель~--- $ 3 $,
            никаких простых делителей, кроме $ 2 $ и $ 3 $ быть не может,
            причём тройка обязана присутствовать в качестве делителя.
    \end{enumerate}
\end{Answer}


\begin{Exercise}[counter=SecExercise, label={exercise:functions:set_operations}]
    \noindent
    Пусть $ f $~--- частичная функция из множества $ A $ в множество $ B $,
    $ X, Y \subseteq A $, $ U, V \subseteq B $.
    Верны ли для любых множеств $ f, A, B, X, Y, U, V $ следующие утверждения:
    \begin{enumerate}[label=\textbf{\alph*)}]
        \item $ f (X \cup Y) = f (X) \cup f (Y) $;
        \item из равенства $ f(X) = f(Y) $ следует $ X \cap Y \neq \varnothing $;
        \item $ f^{-1}(U \cap V) = f^{-1}(U) \cap f^{-1}(V) $;
        \item из равенства $ f^{-1}(U) = f^{-1}(V) $ следует $ U = V $.
    \end{enumerate}
\end{Exercise}

\begin{Answer}
    \noindent
    \begin{enumerate}[label=\textbf{\alph*)}]
        \item
            Верно:
            \begin{multline*}
                f(X \cup Y) = \{ z \mid \exists x \in X \cup Y: f(x) = z \} = \\
                = \{z \mid \left(\exists x \in X: f(x) = z \right) \vee \left( \exists y \in Y: f(y) = z \right) \} = f(X) \cup f(Y)
            \end{multline*}
        \item
            \label{item:functions:constant_mapping}
            Неверно: рассмотрим $ f: \R \ni x \mapsto 0 $ и $ X = Y = \R $.
            Тогда $ f(X) = f(Y) = \{ 0 \} $, но $ X \cap Y \neq \varnothing $.
        \item
            Верно:
            \begin{multline*}
                f^{-1}(U \cap V) = \{ x \mid f(x) \in U \cap V \} = \\
                = \{x \mid (f(x) \in U) \wedge (f(x) \in V) \} = f^{-1}(U) \cap f^{-1}(V)
            \end{multline*}
        \item
            Неверно: рассмотрим тот же пример функции, что и в пункте \ref{item:functions:constant_mapping}.
            В качестве $ U $ и $ V $ возьмём $ \{0\} $ и $ \{0, 1\} $ соответственно.
            Тогда $ f^{-1}(U) = f^{-1}(V) = \R $, но $ U \neq V $.
    \end{enumerate}
\end{Answer}


\begin{Exercise}[counter=SecExercise, label={exercise:functions:map_unmap}]
    \noindent
    Частичная функция $ f $ определена на множестве $ X $ и принимает
    значения в множестве $ Y $, при этом $ B \subseteq Y $.
    Какой знак сравнения можно поставить вместо <<?>>, чтобы утверждение <<$ f (f^{-1}(B)) \; ? \; B $>> стало верным?
\end{Exercise}

\begin{Answer}
    \noindent
    Покажем, что можно поставить знак <<$ \subseteq $>>.
    \[
        y \in f(f^{-1}(B)) \quad \Longleftrightarrow \quad \exists x \in f^{-1}(B): f(x) = y
    \]
    Но $ x \in f^{-1}(B) \; \Longleftrightarrow \; f(x) \in B $.
    Тогда
    \[
        \exists x \in f^{-1}(B): f(x) = y
        %\quad \Longleftrightarrow \quad \exists x: f(x) = y \in B
        \quad \Longleftrightarrow \quad
        \begin{cases}
            \exists x: f(x) = y \\
            y \in B
        \end{cases}
        \quad \Longrightarrow \quad
        y \in B
    \]
    Таким образом, $ y \in f(f^{-1}(B)) \; \Longrightarrow \; y \in B $,
    что и означает $ f(f^{-1}(B)) \subseteq B $.

    Контрпример для равенства можно взять тривиальный: $ f = \varnothing $, $ B \neq \varnothing $.
    Тогда $ f(f^{-1}(B)) = \varnothing \neq B $.
    Также, раз нельзя поставить знак <<$ = $>>,
    то нельзя и <<$ \supseteq $>>.
\end{Answer}

\subsection{Отображения}
\label{subsec:functions:mappings}

Отдельно рассматривается случай, когда функция определена в любой точке из множества аргументов.
В этом случае говорится, что функция является \defemph{отображением}, или \defemph{всюду определённой функцией}.

\begin{definition}
    Функция $ f \subseteq X \times Y $ называется \defemph{отображением} в случае $ \dom(f) = X $.
    При этом пишут $ f: X \to Y $.
\end{definition}

\begin{remark}
    Любая функция становится отображением при сужении множества аргументов до области определения: $ f: \dom(f) \to Y $.
\end{remark}

\begin{definition}
    В случае $ f: X \to X $ отображение $ f $ называют \defemph{преобразованием}
\end{definition}

Среди отображений выделяют следующие три важных вида:

\begin{definition}
    Отображение $ f: X \to Y $ называется \defemph{инъекцией} $ \defarr $ $ \forall x_1, x_2 \in X \;\, (x_1 \neq x_2) \rightarrow (f(x_1) \neq f(x_2)) $.
    То есть, из неравенства аргументов следует неравенство значений отображения.
\end{definition}

\begin{definition}
    Отображение $ f: X \to Y $ называется \defemph{сюръекцией} $ \defarr $ $ \range(f) = Y $.
    То есть, у любого элемента из $ Y $ существует прообраз.
\end{definition}

\begin{definition}
    Отображение $ f: X \to Y $ называется \defemph{биекцией} в случае, когда оно и инъекция, и сюръекция.
\end{definition}

\begin{remark}
    Биекция является правилом, взаимнооднозначно сопостовляющим каждому элементу из $ X $ некоторый элемент из $ Y $ и наоборот.
\end{remark}

\begin{corollary}
    Каждое биективное отображение \defemph{обратимо}, то есть если $ f: X \to Y $~--- биекция, то
    \[
        g = f^{-1} \defeq \{ (y, x) \in Y \times X \mid (x, y) \in f \}
    \]
    является отображением, причём биекцией.
\end{corollary}

\begin{example}
    \label{example:functions:mappings}
    \begin{enumerate}
        \item[]
        \item
            Пусть $ f: \R^2 \to \R^3 $~--- отображение, ставящее в соответствие паре чисел $ (x_1, x_2) $ коэффициенты $ (a, b, c) $
            квадратного уравнения, корнями которого являются $ (x_1, x_2) $, причём $ a = 1 $.

            Это \textbf{инъекция}, так как $ (a, b, c) = (1, \, - x_1 - x_2, \, x_1 x_2) $, и равенство всех значений невозможно при $ (x_1', x_2') \neq (x_1'', x_2'') $.
            С другой стороны, это \textbf{не сюръекция}, так как у троек с $ a \neq 1 $ нет прообразов.
        \item
            Пусть $ X $~--- множество многочленов степени не выше $ m+1 $, а $ Y $~--- многочленов степени не выше $ m $.

            Рассмотрим операцию взятия производной $ \frac{d}{dx}: X \to Y $, то есть $ \frac{d}{dx}: p(x) \mapsto p'(x) $.

            Это \textbf{сюръекция}, но \textbf{не инъекция}: для каждого многочлена из $ Y $ есть прообраз в $ X $~--- его интеграл, но при этом любой константный многочлен отображается в ноль.
        \item
            Пусть $ f: [0;1] \to [0;1] $ непрерывна и монотонно возрастает.
            Тогда по теореме об обратной функции это \textbf{биекция}.
    \end{enumerate}
\end{example}

\begin{Exercise}[counter=SecExercise]
    \noindent
    Пусть $ f: X \to X $~--- сюръективное преобразование.
    Верно ли, что $ f $ инъективно?
\end{Exercise}

\begin{Answer}
    \noindent
    Нет.
    Приведём контрпример: пусть $ X $~--- множество всех многочленов, а $ f = \frac{d}{dx} $.
    Аналогично рассуждениям в примере \ref{example:functions:mappings} получаем, что $ f $~--- сюръекция, но не инъекция.

    Заметим однако, что если $ X $ конечно, то утверждение в условии верно.
    Предлагаю вам самим это проверить.
\end{Answer}

\begin{Exercise}[counter=SecExercise, label={exercise:functions:infinite_surjection}]
    \noindent
    Приведите пример сюръективного преобразования $ f: \N \to \N $ такого, что полный прообраз каждого элемента $ \N $ бесконечен.
\end{Exercise}

\begin{Answer}
    \noindent
    Выпишем подряд все элементы $ \N $.
    Вычеркнем все числа, стоящие на нечётных позициях.
    Для оставшихся чисел повторим операцию, и так далее.

    Пусть теперь $ f $ сопоставляет числу номер шага, на котором его вычеркнули.
    Это действительно отображение, так как после каждого шага минимальное число среди невычеркнутых растёт,
    из чего следует, что любое число будет вычеркнуто на каком-то шаге.
    Это действительно сюръекция, так как на любом шаге вычёркивается хотя бы одно число.
    И, наконец, полным прообразом каждого элемента $ \N $ будет бесконечное множество,
    так как на каждом шаге вычёркивается бесконечное множество чисел.
\end{Answer}


\subsection{Функции и мощность множества}
\label{subsec:functions:cardinality}

Изученные нами понятия также играют важную роль и в теории множеств.
Помимо состава множеств и взаимоотношений между ними нас часто будет интересовать то, насколько некоторое множество <<велико>>.
Легко определить <<размер>> множества в случае, когда оно конечно: это просто число элементов.
Но что делать, если множество содержит бесконечно много элементов?
Хочется сказать, что если два множества бесконечны, то они <<равновелики>>.
Однако это противоречит интуитивным представлениям о том, что, например, $ 2^A $ содержит элементов больше, чем $ A $.

Оказывается, эти интуитивные представления можно формализовать, если по-другому взглянуть на размер конечных множеств.
Если множества $ A $ и $ B $ конечны, то можно сказать, что они равновелики, если в них одинаковое число элементов.
По сути, это эквивалентно тому, что можно задать взаимнооднозначное правило соответствия~--- \textit{биекцию}~--- между каждым элементом $ A $ и $ B $.

\begin{statement}
    \label{statement:functions:finite_bijection}
    Если $ A $ и $ B $~--- конечные множества, то они содержат одинаковое число элементов тогда и только тогда,
    когда существует биекция из одного множества в другое.
\end{statement}

Формальное доказательство утверждения становится очевидным, если любым способом пронумеровать элементы множеств.

Данное утверждение позволяет по-иному формально определить размер, или \defemph{мощность} множества, и обобщить это определение на все множества вообще.
\begin{definition}
    Множества $ A $ и $ B $ называются \defemph{равномощными} в том и только том случае,
    если существует биекция между элементами множеств.
\end{definition}
Стоит обратить внимание, что требуемая биекция не обязана быть единственной.

\begin{definition}
    Множество $ A $ называется \defemph{счётным} $ \defarr $ $ A $ равномощно $ \N_0 $.
\end{definition}

\begin{example}
    \begin{enumerate}
        \item[]
        \item
            Множества $ \{1, 2\} $ и $ \{a, x\} $ равномощны, причём можно построить две биекции между ними:
            \[
                1 \sim a, \; 2 \sim x \qquad \text{или} \qquad 1 \sim x, \; 2 \sim a
            \]
        \item
            Множества $ \N_0 $ и $ E = \{ x \in \N_0 \mid \exists k \, (x = 2k) \} $ равномощны, биекция задаётся, например, правилом $ E \ni x = 2 \cdot k $, где $ k $~--- любой элемент $ \N_0 $.
        \item
            Множества $ \Q $ и $ \N_0 $ равномощны.
            Идея доказательства: $ \Q $ можно задать бесконечной таблицей, номер строки и столбца в которой~--- числитель и знаменатель.
            А все ячейки таблицы можно пронумеровать, идя <<змейкой>> (при этом сократимые дроби не нумеруются).
    \end{enumerate}
\end{example}

Может создасться впечатление, что все бесконечные множества счётны.
Однако это неверно.

\begin{theorem}[Кантора]
    Для любого $ A $ множества $ A $ и $ 2^A $ неравномощны.
\end{theorem}

\begin{statement}
    Множество $ \R $ несчётно.
\end{statement}

Доказательство данного утверждения обычно приводят в курсе математического анализа.

\begin{Exercise}[counter=SecExercise]
    \noindent
    Счётно ли множество всех корректных программ, написанных на языке C++?
\end{Exercise}

\begin{Answer}
    \noindent
    Да, оно счётно.
    Для доказательства этого заметим, что можно построить следующую таблицу:
    номер строки равен длине программы в символах, а номер столбца~--- лексикографическому порядковому номеру программы среди всех программ заданной длины.
    Обходя таблицу <<змейкой>>, получаем взаимнооднозначную нумерацию всех программ.
\end{Answer}

На текущий момент мы формально определили лишь случай равенства мощностей двух бесконечных множеств.
Можно пойти дальше и определить оставшиеся операции сравнения.
Нетрудно проверить, что утверждение \ref{statement:functions:finite_bijection} можно обобщить в виде следующей леммы:

\begin{lemma}
    \label{lemma:functions:finite_cardinality_compare}
    Пусть $ A $ и $ B $~--- конечные множества.
    Тогда
    \begin{enumerate}
        \item $ |A| = |B| $ $ \Longleftrightarrow $ существует биекция между $ A $ и $ B $.
        \item $ |A| \leqslant |B| $ $ \Longleftrightarrow $ существует инъекция из $ A $ в $ B $.
        \item $ |A| \geqslant |B| $ $ \Longleftrightarrow $ существует сюръекция из $ A $ в $ B $.
    \end{enumerate}
\end{lemma}

Обобщим эту лемму на случай произвольных множеств, определив соответствующим образом операции сравнения.

\begin{definition}
    \label{definition:functions:cardinaluty_compare}
    В случае существования инъекции $ f: A \to B $ говорят, что \defemph{$ B $ не менее мощно, чем $ A $}.
    Это обозначается как $ |A| \leqslant |B| $.
    При этом по определению полагают $ (|A| < |B|) \defarr (|A| \leqslant |B|) \wedge (|A| \neq |B|) $.
\end{definition}

%\begin{statement}
%    Данное определение операции сравнения мощностей эквивалентно сравнению числа элементов в случае конечных множеств.
%\end{statement}

\begin{statement}
    \label{statement:functions:cardinality_compare_equivalence}
    Множество $ B $ не менее мощно, чем множество $ A $, тогда и только тогда, когда существует сюръекция $ g: B \to A $.
\end{statement}

\begin{proof}
    \begin{enumerate}
        \item[]
        \item[$\Rightarrow$]
            По определению, существует инъекция $ f: A \to B $.
            Заметим тогда, что $ g' = \{ (y, x) \in B \times A \mid (x, y) \in f \} $ является частичной функцией.
            Действительно, раз $ f $~--- инъекция, ни у каких двух (разных) пар из $ f $ не совпадают вторые элементы.
            Значит, ни у каких двух (разных) пар из $ g' $ не совпадают первые элементы.

            Заметим также, что $ g': \dom(g') \to A $~--- сюръекция.
            Действительно, так как $ f $~--- отображение, любой элемент $ A $ является первым элементом хотя бы какой-то пары из $ f $.
            Но тогда он же является и вторым элементом некоторой пары из $ g' $.

            Тогда построим $ g $ как произвольное доопределение $ g' $ на $ B $.
            Таким образом, получена сюръекция $ g: B \to A $.
        \item[$\Leftarrow$]
            Аналогично.
    \end{enumerate}
\end{proof}

Из данного утверждения следует, что лемма \ref{lemma:functions:finite_cardinality_compare}
обобщается и на случай бесконечных множеств при использовании определения \ref{definition:functions:cardinaluty_compare}.
